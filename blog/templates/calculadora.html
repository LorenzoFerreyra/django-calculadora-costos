{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calculadora para Emprendedores Sociales</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #F9FAFB; }
        .calculator-card { max-width: 540px; margin: 2rem auto; }
        .result-box { background: #eaf6fb; border-radius: 8px; padding: 1rem; }
        .footer { color: #888; font-size: 0.95em; }
        .cost-list { background: #fff; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold text-primary" href="#">Calculadora Social</a>
            <div class="collapse navbar-collapse justify-content-end">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="#">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Sobre</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Contacto</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Iniciar sesión (opcional)</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main>
        <div class="calculator-card bg-white rounded shadow p-4">
            <h2 class="mb-2 fw-bold text-center">Calculadora de Costos para Emprendedores</h2>
            <p class="text-center text-muted mb-4">Sumá tus costos, calculá tu ganancia y descubrí si tu producto te deja plata.</p>

            {% if mensaje %}
            <div class="alert alert-warning">{{ mensaje }}</div>
            {% endif %}

            <div class="cost-list">
                <h5>Lista de costos</h5>
                {% if costos %}
                <ul class="list-group mb-2">
                    {% for c in costos %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ c.nombre }}
                        <span class="badge bg-primary">${{ c.valor }}</span>
                    </li>
                    {% endfor %}
                </ul>
                <form method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" name="limpiar_costos" class="btn btn-sm btn-danger">Limpiar costos</button>
                </form>
                {% else %}
                <p class="text-muted">No agregaste ningún costo todavía.</p>
                {% endif %}
            </div>

            <form method="post" class="mb-4">
                {% csrf_token %}
                <div class="mb-3">
                    <label class="form-label">Nombre del costo</label>
                    <input type="text" name="nombre" class="form-control" placeholder="Ej: Pan, carne, gas, etc." required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Valor ($)</label>
                    <input type="number" step="0.01" min="0" name="valor" class="form-control" placeholder="Ej: 100" required>
                </div>
                <button type="submit" name="agregar_costo" class="btn btn-success w-100">Agregar costo</button>
            </form>

            <form method="post">
                {% csrf_token %}
                <div class="mb-3">
                    <label class="form-label">Precio de venta por producto ($)</label>
                    <input type="number" step="0.01" min="0" name="precio_venta" class="form-control" placeholder="Ej: 200" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Cantidad que pensás vender</label>
                    <input type="number" min="1" name="cantidad" class="form-control" placeholder="Ej: 10" required>
                </div>
                <button type="submit" name="calcular" class="btn btn-primary w-100">Calcular ganancia</button>
            </form>

            {% if resultado %}
            <div class="result-box mt-4">
                <h5 class="fw-semibold mb-3">Resultados</h5>
                <div><strong>Ingreso total:</strong> ${{ resultado.ingreso_total }}</div>
                <div><strong>Costo total:</strong> ${{ resultado.costo_total }}</div>
                <div><strong>Ganancia neta:</strong> ${{ resultado.ganancia }}</div>
                <div><strong>Margen (%):</strong> {{ resultado.margen }}%</div>
                {% if resultado.ganancia < 0 %}
                <div class="alert alert-danger mt-3">¡Atención! Estás perdiendo plata.</div>
                {% elif resultado.ganancia == 0 %}
                <div class="alert alert-warning mt-3">No ganás ni perdés. ¡Revisá tus precios!</div>
                {% else %}
                <div class="alert alert-success mt-3">¡Felicitaciones! Estás ganando plata.</div>
                {% endif %}
            </div>
            {% endif %}
        </div>
    </main>

    <footer class="footer text-center mt-5 mb-3">
        © 2025 Tu Emprendimiento &middot; <a href="#">Contacto</a>
    </footer>
</body>
</html>